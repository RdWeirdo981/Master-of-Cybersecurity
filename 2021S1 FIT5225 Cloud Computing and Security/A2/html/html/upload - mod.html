<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
		<script src="https://sdk.amazonaws.com/js/aws-sdk-2.7.16.min.js"></script> 
		<script src="js/config.js"></script>
    </head>
    <body>
        <input id="file" type="file" onchange="imgChange(this)" accept="image/*" />
        <img width="300" height="300" src="">
		<button id="upload-button" onclick="uploadButton()">Upload</button>
        <script type="text/javascript">
            function imgChange(obj) {
                var image = obj.files[0]; //获取文件域中选中的图片
                var reader = new FileReader(); //实例化文件读取对象
                reader.readAsDataURL(image); //将文件读取为 DataURL,也就是base64编码
                reader.onload = function(ev) { //文件读取成功完成时触发
                    var dataURL = ev.target.result; //获得文件读取成功后的DataURL,也就是base64编码
                    document.querySelector("img").src = dataURL; //将DataURL码赋值给img标签
                    console.log(dataURL);
                }
            }
		</script>
		
		<script type="text/javascript">
			function uploadButton(){
					
				let dataURL = document.querySelector("img").src
				
				
				var myHeaders = new Headers();
				myHeaders.append("Content-Type", "image/jpeg");

				var raw = JSON.stringify({"content":dataURL});
				
				var requestOptions = {
					method: 'POST',
					headers: myHeaders,
					body: raw,
					redirect: 'follow'
				};

				fetch("https://yv3pcqir0a.execute-api.us-east-1.amazonaws.com/ImageDetection/uploadimagefunction", requestOptions)
				.then(response => response.text())
				.then(result => console.log(result))
				.catch(error => console.log('error', error));
				
			}
        </script>
		
		
		
		
		
    </body>
</html>